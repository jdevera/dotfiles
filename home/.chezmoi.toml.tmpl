# By default, chezmoi diff will print the contents of scripts that would be run
# by chezmoi apply. To exclude scripts from the output of chezmoi diff, set
# diff.exclude in your configuration file, for example:
[diff]
    exclude = ["scripts"]

# chezmoi provides a hooks.read-source-state.pre hook that allows you to modify
# your system after chezmoi init has cloned your dotfile repo but before chezmoi
# has read the source state. This is the perfect time to install your password
# manager as you can assume that ~/.local/share/chezmoi is populated but has not
# yet been read.
[hooks.read-source-state.pre]
    command = ".local/share/chezmoi/home/.install-one-password.sh"

# ------------------------------------------------------------
# Data
# ------------------------------------------------------------
{{- $email := promptStringOnce . "email" "Email address" -}}
{{- $fname := promptStringOnce . "fname" "Full Name" -}}
{{- $ghuser := promptStringOnce . "ghuser" "Github User" -}}

{{- /* Interactive hosts are hosts I interact directly with, rather than through
        other machines. */ -}}

{{- $interactive_hosts := list "nexon" -}}
{{- $is_interactive := false -}}

{{- if eq .chezmoi.os "darwin" -}}
{{-     $is_interactive = true -}}
{{- else -}}
{{-     range $interactive_hosts -}}
{{-         if eq . $.chezmoi.hostname -}}
{{-             $is_interactive = true -}}
{{-         end -}}
{{-     end -}}
{{- end }}

{{- /* Headless detection - systems that should NOT have GUI packages */ -}}
{{- $headful_hosts := list "nexon" -}}
{{- $is_headless := true -}}

{{- /* Never headless on macOS */ -}}
{{- if eq .chezmoi.os "darwin" -}}
{{-     $is_headless = false -}}
{{- else -}}
{{- /* Check if hostname is in explicit headful hosts list */ -}}
{{-     range $headful_hosts -}}
{{-         if eq . $.chezmoi.hostname -}}
{{-             $is_headless = false -}}
{{-         end -}}
{{-     end -}}
{{- end }}

[data]
    email = {{ $email | quote }}
    fname = {{ $fname | quote }}
    ghuser = {{ $ghuser | quote }}
    is_macos = {{ eq .chezmoi.os "darwin" }}
    is_linux = {{ eq .chezmoi.os "linux" }}
    is_interactive = {{ $is_interactive }}
    is_headless = {{ $is_headless }}


# vim:ft=toml:
